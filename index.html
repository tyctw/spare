<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <title>會考落點分析 | 免費高中落點分析工具</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google-adsense-account" content="ca-pub-3350304014189563" />
    <meta
      name="description"
      content="免費會考落點分析系統，幫助您快速分析國中會考成績對應的高中落點，提供精確的學校錄取機率評估及分析報告。提供匯出功能及學校比較工具。"
    />
    <meta
      name="keywords"
      content="會考落點分析,會考成績分析,高中落點分析,免費落點分析,桃聯區,中投區,高雄區,彰化區,國中會考,高中錄取,學校比較,大學升學,升學分析,國中升高中,會考分數,武陵高中,中壢高中,內壢高中,平鎮高中,大園高中,永豐高中,南崁高中,振聲高中,楊梅高中,治平高中,新興高中,關西高中,大溪高中"
    />
    <meta name="author" content="落點分析研究團隊" />
    <meta property="og:title" content="會考落點分析 | 免費高中落點分析工具" />
    <meta property="og:description" content="免費會考落點分析系統，幫助您快速分析國中會考成績對應的高中落點，提供精確的學校錄取機率評估及分析報告。" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://tyctw.github.io/spare/" />
    <meta property="og:image" content="https://tyctw.github.io/spare/og-image.jpg" />
    <meta property="og:site_name" content="會考落點分析系統" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="會考落點分析 | 免費高中落點分析工具" />
    <meta name="twitter:description" content="免費會考落點分析系統，幫助您快速分析國中會考成績對應的高中落點，提供精確的學校錄取機率評估及分析報告。" />
    <meta name="twitter:image" content="https://tyctw.github.io/spare/og-image.jpg" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <link rel="canonical" href="https://tyctw.github.io/spare/" />
    <!-- External JS Libraries -->
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.3.1/dist/jsQR.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
      /* 新增樣式，用於顯示正在籌備中的區域 */
      .region-option.disabled {
        opacity: 0.7;
        position: relative;
      }
      
      .region-option.disabled::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.05);
        pointer-events: none;
        border-radius: inherit;
      }
      
      .region-feature.preparing {
        color: #ff6b6b;
        font-weight: bold;
      }
      
      .region-option.disabled .region-label {
        cursor: not-allowed;
      }
      
      /* 區域選擇彈窗樣式 */
      #regionModal {
        display: none;
        position: fixed;
        z-index: 1001;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5);
      }
      
      .region-modal-content {
        background-color: white;
        margin: 5% auto;
        padding: 20px;
        border-radius: 15px;
        width: 90%;
        max-width: 800px;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        animation: slideIn 0.3s ease-out;
      }
      
      .region-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 15px;
        margin-bottom: 20px;
      }
      
      .region-modal-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--primary-color);
      }
      
      .region-select-btn {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 15px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .region-select-btn:hover {
        background-color: var(--hover-color);
        transform: translateY(-2px);
      }
      
      .selected-region {
        margin-left: 10px;
        font-weight: normal;
        opacity: 0.8;
      }
      
      /* 計分方式顯示區域樣式 */
      .scoring-info {
        display: none;
        margin-top: 15px;
        padding: 15px;
        background-color: #f8f9fa;
        border-left: 4px solid var(--primary-color);
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        animation: fadeIn 0.5s ease-in-out;
      }
      
      .scoring-info.active {
        display: block;
      }
      
      .scoring-info-title {
        font-weight: 600;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--primary-color);
      }
      
      .scoring-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 10px;
      }
      
      .scoring-item {
        background-color: white;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }
      
      .scoring-item-header {
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 5px;
        margin-bottom: 5px;
        color: #333;
      }
      
      .scoring-item-value {
        font-size: 0.9rem;
        color: #555;
      }
      
      .loading-spinner {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(0,0,0,0.1);
        border-radius: 50%;
        border-top-color: var(--primary-color);
        animation: spin 1s ease-in-out infinite;
        margin-right: 10px;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      @keyframes slideIn {
        from {
          transform: translateY(-50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      
      /* 職業群別彈窗樣式 */
      #vocationalGroupModal {
        display: none;
        position: fixed;
        z-index: 1001;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5);
      }
      
      .vocational-modal-content {
        background-color: white;
        margin: 5% auto;
        padding: 20px;
        border-radius: 15px;
        width: 90%;
        max-width: 800px;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        animation: slideIn 0.3s ease-out;
      }
      
      .vocational-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 15px;
        margin-bottom: 20px;
      }
      
      .vocational-modal-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--primary-color);
      }
      
      .vocational-select-btn {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 15px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .vocational-select-btn:hover {
        background-color: var(--hover-color);
        transform: translateY(-2px);
      }
      
      .selected-vocational-groups {
        margin-left: 10px;
        font-weight: normal;
        opacity: 0.8;
      }
      
      /* 更新日誌樣式 */
      .changelog-modal-content {
        max-width: 800px;
        max-height: 85vh;
      }
      
      .changelog-container {
        max-height: 60vh;
        overflow-y: auto;
        padding-right: 10px;
        margin-bottom: 20px;
      }
      
      .changelog-entry {
        margin-bottom: 30px;
        border-left: 4px solid var(--primary-color);
        padding-left: 15px;
        position: relative;
      }
      
      .changelog-entry:before {
        content: '';
        position: absolute;
        left: -10px;
        top: 0;
        width: 16px;
        height: 16px;
        background-color: var(--primary-color);
        border-radius: 50%;
      }
      
      .changelog-version {
        font-size: 1.4rem;
        font-weight: 600;
        color: var(--primary-color);
        margin-bottom: 5px;
      }
      
      .changelog-date {
        font-size: 0.9rem;
        color: var(--text-secondary-color);
        margin-bottom: 15px;
      }
      
      .changelog-changes ul {
        list-style-type: none;
        padding-left: 0;
      }
      
      .changelog-changes li {
        margin-bottom: 12px;
        padding: 10px;
        border-radius: 8px;
        background-color: rgba(var(--primary-rgb), 0.05);
        transition: all 0.3s ease;
      }
      
      .changelog-changes li:hover {
        background-color: rgba(var(--primary-rgb), 0.1);
        transform: translateX(5px);
      }
      
      .changelog-changes li .icon {
        color: var(--primary-color);
        margin-right: 8px;
      }
      
      @media (max-width: 768px) {
        .changelog-version {
          font-size: 1.2rem;
        }
        
        .changelog-changes li {
          padding: 8px;
        }
      }
      
      /* 新表單按鈕樣式 */
      .new-form-button-container {
        position: relative;
        margin: 20px auto;
        max-width: 500px;
      }
      
      .new-form-button {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0;
        border-radius: 12px;
        background: linear-gradient(135deg, var(--primary-color) 0%, #34a0db 100%);
        color: white;
        text-decoration: none;
        overflow: hidden;
        position: relative;
        box-shadow: 0 8px 20px rgba(var(--primary-rgb), 0.3);
        transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
      }
      
      .new-form-button:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 25px rgba(var(--primary-rgb), 0.4);
      }
      
      .new-form-button:active {
        transform: translateY(0);
        box-shadow: 0 5px 15px rgba(var(--primary-rgb), 0.2);
      }
      
      .button-content {
        display: flex;
        align-items: center;
        padding: 16px 20px;
        width: calc(100% - 60px);
        z-index: 2;
      }
      
      .button-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 50px;
        height: 50px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        margin-right: 15px;
        flex-shrink: 0;
      }
      
      .button-icon i {
        font-size: 24px;
        color: white;
      }
      
      .button-text {
        display: flex;
        flex-direction: column;
      }
      
      .button-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 5px;
      }
      
      .button-subtitle {
        font-size: 0.85rem;
        opacity: 0.8;
      }
      
      .button-arrow {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 60px;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.1);
        z-index: 2;
        transition: all 0.3s ease;
      }
      
      .new-form-button:hover .button-arrow {
        background-color: rgba(0, 0, 0, 0.2);
        transform: translateX(5px);
      }
      
      .new-form-button:hover .button-arrow i {
        animation: bounceRight 1s infinite;
      }
      
      .form-button-badge {
        position: absolute;
        top: -10px;
        right: -5px;
        background-color: #ff6b6b;
        color: white;
        font-size: 0.8rem;
        font-weight: 600;
        padding: 5px 10px;
        border-radius: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        z-index: 3;
        transform: rotate(3deg);
        animation: pulse 2s infinite;
      }
      
      .form-button-badge i {
        font-size: 0.7rem;
        margin-right: 3px;
        animation: rotateStar 3s linear infinite;
      }
      
      .pulse-effect {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        background: radial-gradient(circle, rgba(255,255,255,0.5) 0%, rgba(255,255,255,0) 70%);
        opacity: 0;
        z-index: 1;
      }
      
      .new-form-button:hover .pulse-effect {
        animation: pulseEffect 1.5s infinite;
      }
      
      @keyframes bounceRight {
        0%, 100% { transform: translateX(0); }
        50% { transform: translateX(5px); }
      }
      
      @keyframes pulse {
        0% { transform: scale(1) rotate(3deg); }
        50% { transform: scale(1.05) rotate(3deg); }
        100% { transform: scale(1) rotate(3deg); }
      }
      
      @keyframes rotateStar {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      @keyframes pulseEffect {
        0% { opacity: 0; transform: scale(0.8); }
        50% { opacity: 0.5; transform: scale(1.5); }
        100% { opacity: 0; transform: scale(2); }
      }
      
      @media (max-width: 600px) {
        .new-form-button-container {
          max-width: 100%;
          margin: 15px 10px;
        }
        
        .button-content {
          padding: 12px 15px;
        }
        
        .button-icon {
          width: 40px;
          height: 40px;
          margin-right: 10px;
        }
        
        .button-icon i {
          font-size: 20px;
        }
        
        .button-title {
          font-size: 1rem;
        }
        
        .button-subtitle {
          font-size: 0.75rem;
        }
      }
      
      /* 區域分類樣式 */
      .region-category {
        padding: 15px;
        font-size: 1.2rem;
        font-weight: 600;
        color: var(--primary-color);
        background-color: rgba(var(--primary-rgb), 0.05);
        border-radius: 10px;
        margin: 20px 0 10px 0;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      .region-category i {
        color: var(--primary-color);
      }
      
      .preparing-category {
        color: #ff6b6b;
        background-color: rgba(255, 107, 107, 0.05);
        margin-top: 30px;
      }
      
      .preparing-category i {
        color: #ff6b6b;
      }
      
      @media (max-width: 768px) {
        .region-category {
          font-size: 1.1rem;
          padding: 12px;
        }
      }
      
      /* 深色模式樣式調整 */
      .dark-mode {
        --primary-color: #4a89dc;
        --primary-rgb: 74, 137, 220;
        --secondary-color: #5d9cec;
        --text-color: #e0e0e0;
        --text-secondary-color: #b0b0b0;
        --background-color: #121212;
        --card-bg-color: #1e1e1e;
        --border-color: #333;
        --hover-color: #3a70c0;
        --disabled-color: #555;
        --error-color: #ff6b6b;
        --success-color: #5cb85c;
        --input-bg: #2d2d2d;
        --shadow-color: rgba(0, 0, 0, 0.5);
      }
      
      /* 為新增的區域類別添加深色模式樣式 */
      .dark-mode .region-category {
        background-color: rgba(var(--primary-rgb), 0.15);
        color: var(--primary-color);
      }
      
      .dark-mode .preparing-category {
        background-color: rgba(255, 107, 107, 0.1);
        color: #ff8a8a;
      }
      
      .dark-mode .preparing-category i {
        color: #ff8a8a;
      }
      
      /* 為更新日誌添加深色模式樣式 */
      .dark-mode .changelog-modal-content {
        background-color: var(--card-bg-color);
        color: var(--text-color);
      }
      
      .dark-mode .changelog-version {
        color: var(--primary-color);
      }
      
      .dark-mode .changelog-date {
        color: var(--text-secondary-color);
      }
      
      .dark-mode .changelog-changes li {
        background-color: rgba(var(--primary-rgb), 0.1);
      }
      
      .dark-mode .changelog-changes li:hover {
        background-color: rgba(var(--primary-rgb), 0.2);
      }
      
      .dark-mode .changelog-changes li .icon {
        color: var(--primary-color);
      }
      
      .dark-mode .changelog-entry {
        border-left-color: var(--primary-color);
      }
      
      .dark-mode .changelog-entry:before {
        background-color: var(--primary-color);
      }
      
      /* 為新表單按鈕添加深色模式樣式 */
      .dark-mode .new-form-button {
        background: linear-gradient(135deg, var(--primary-color) 0%, #2a65b8 100%);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
      }
      
      .dark-mode .button-icon {
        background-color: rgba(255, 255, 255, 0.1);
      }
      
      .dark-mode .button-arrow {
        background-color: rgba(0, 0, 0, 0.3);
      }
      
      .dark-mode .new-form-button:hover .button-arrow {
        background-color: rgba(0, 0, 0, 0.4);
      }
      
      .dark-mode .form-button-badge {
        background-color: #ff8a8a;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }
      
      /* 為區域選擇彈窗添加深色模式樣式 */
      .dark-mode .region-modal-content {
        background-color: var(--card-bg-color);
        color: var(--text-color);
      }
      
      .dark-mode .region-modal-title {
        color: var(--primary-color);
      }
      
      .dark-mode .region-option {
        background-color: var(--background-color);
      }
      
      .dark-mode .region-label {
        background-color: var(--card-bg-color);
        border: 1px solid var(--border-color);
      }
      
      .dark-mode .region-name {
        color: var(--text-color);
      }
      
      .dark-mode .region-description {
        color: var(--text-secondary-color);
      }
      
      .dark-mode .region-feature {
        color: var(--text-color);
        background-color: rgba(var(--primary-rgb), 0.1);
      }
      
      .dark-mode .region-feature.preparing {
        color: #ff8a8a;
      }
      
      .dark-mode .region-option.disabled .region-label {
        background-color: #1a1a1a;
        border-color: #2a2a2a;
      }
      
      .dark-mode .region-option.disabled::after {
        background-color: rgba(0, 0, 0, 0.3);
      }
      
      /* 為職業群別彈窗添加深色模式樣式 */
      .dark-mode .vocational-modal-content {
        background-color: var(--card-bg-color);
        color: var(--text-color);
      }
      
      .dark-mode .vocational-modal-title {
        color: var(--primary-color);
      }
      
      .dark-mode .vocational-group-label {
        background-color: var(--card-bg-color);
        border: 1px solid var(--border-color);
        color: var(--text-color);
      }
      
      .dark-mode .vocational-group-input:checked + .vocational-group-label {
        background-color: rgba(var(--primary-rgb), 0.2);
        border-color: var(--primary-color);
      }
      
      /* 為計分方式面板添加深色模式樣式 */
      .dark-mode .scoring-info {
        background-color: var(--card-bg-color);
        border-left-color: var(--primary-color);
      }
      
      .dark-mode .scoring-info-title {
        color: var(--primary-color);
      }
      
      .dark-mode .scoring-item {
        background-color: var(--background-color);
      }
      
      .dark-mode .scoring-item-header {
        color: var(--text-color);
      }
      
      .dark-mode .scoring-item-value {
        color: var(--text-secondary-color);
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header-container">
        <div class="header-logo hover-glow">
          <i class="fas fa-chart-line"></i>
          <span>會考落點分析</span>
        </div>
        <div class="header-actions">
          <button class="header-button hover-glow" onclick="showInstructions()">
            <i class="fas fa-info-circle"></i> 使用說明
          </button>
          <button class="header-button hover-glow" onclick="showDisclaimer()">
            <i class="fas fa-shield-alt"></i> 免責聲明
          </button>
        </div>
        <div class="menu-icon" onclick="toggleMenu()">
          <i class="fas fa-bars"></i>
        </div>
      </div>
    </header>

    <div class="menu-overlay" id="menuOverlay" onclick="closeMenu()"></div>
    <div class="fullscreen-menu" id="fullscreenMenu">
      <div class="close-menu" onclick="closeMenu()">
        <i class="fas fa-times"></i>
      </div>
      
      <div class="menu-content">
        <div class="menu-section">
          <div class="menu-category">主要功能</div>
          <a href="#" onclick="closeMenu(); window.scrollTo(0, 0);" class="hover-glow">
            <i class="fas fa-home"></i> 首頁
          </a>
          <a href="#" onclick="closeMenu(); showInstructions();" class="hover-glow">
            <i class="fas fa-book"></i> 使用說明
          </a>
          <a href="#" onclick="closeMenu(); showDisclaimer();" class="hover-glow">
            <i class="fas fa-shield-alt"></i> 免責聲明
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-category">數據與工具</div>
          <a href="#" onclick="closeMenu(); toggleDarkMode();" class="hover-glow">
            <i class="fas fa-moon"></i> 深色模式
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-category">關聯系統</div>
          <a href="https://sites.google.com/view/tyctw/" target="_blank" class="hover-glow">
            <i class="fas fa-school"></i> 回到主網頁
          </a>
          <a href="https://tyctw.github.io/sequence/" target="_blank" class="hover-glow">
            <i class="fas fa-pencil-alt"></i> 各校序位推估
          </a>
          <a href="https://tyctw.github.io/Navigation/" class="hover-glow">
            <i class="fas fa-university"></i> 學校導航系統
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-category">系統資訊</div>
          <a href="#" onclick="closeMenu(); showChangeLog();" class="hover-glow">
            <i class="fas fa-history"></i> 更新日誌
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-category">支援與回饋</div>
          <a href="https://forms.gle/e5tHU1haqpHRU7nJ9" target="_blank" class="hover-glow">
            <i class="fas fa-envelope-open-text"></i> 獲取邀請碼
          </a>
          <a href="https://tyctw.github.io/report_form" target="_blank" class="hover-glow">
            <i class="fas fa-exclamation-triangle"></i> 系統異常回報
          </a>
          <a href="#" onclick="closeMenu(); showRatingSection();" class="hover-glow">
            <i class="fas fa-star"></i> 評分與建議
          </a>
        </div>
        
        <div class="menu-footer">
          <div class="menu-social">
            <a href="https://www.threads.net/@114.rcpet" title="Threads" target="_blank" class="hover-glow">
              <img src="https://tyctw.github.io/spare/threads-white-icon.svg" alt="Threads" style="width:24px; height:24px;">
            </a>
            <a href="https://www.instagram.com/p/DGmtMeLvUQ2/?utm_source=ig_web_copy_link&igsh=MzRlODBiNWFlZA%3D%3D" title="Instagram" class="hover-glow">
              <i class="fab fa-instagram"></i>
            </a>
          </div>
          <div class="menu-version">
            版本: 2.0 <span id="menuVersionYear">2025</span>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <h1 class="slide-in">
        <i class="fas fa-chart-line icon"></i>會考落點分析系統
      </h1>
      <div class="new-form-button-container slide-in" style="animation-delay: 0.15s;">
        <a href="https://forms.gle/e5tHU1haqpHRU7nJ9" target="_blank" class="new-form-button">
          <div class="button-content">
            <div class="button-icon">
              <i class="fas fa-file-alt"></i>
            </div>
            <div class="button-text">
              <span class="button-title">填寫表單獲取邀請碼</span>
              <span class="button-subtitle">快速獲取系統存取權限</span>
            </div>
          </div>
          <div class="button-arrow">
            <i class="fas fa-arrow-right"></i>
          </div>
          <div class="pulse-effect"></div>
        </a>
        <div class="form-button-badge">
          <i class="fas fa-star"></i> 推薦
        </div>
      </div>
      <button class="instruction-toggle hover-glow" onclick="showInstructions()">
        <i class="fas fa-info-circle icon"></i>使用說明
      </button>
      <button class="disclaimer-toggle hover-glow" onclick="showDisclaimer()">
        <i class="fas fa-exclamation-triangle icon"></i>免責聲明
      </button>
      <button class="disclaimer-toggle hover-glow" onclick="showChangeLog()">
        <i class="fas fa-history icon"></i>更新日誌
      </button>
      <form id="analysisForm" class="slide-in" style="animation-delay: 0.2s;">
        <div class="form-group">
          <label for="invitationCode">
            <i class="fas fa-key icon"></i>邀請碼：
          </label>
          <input
            type="text"
            id="invitationCode"
            required
            placeholder="請輸入邀請碼"
            class="hover-glow"
          />
        </div>

        <div class="qr-options">
          <button type="button" id="scanQRCode" class="hover-glow">
            <i class="fas fa-camera icon"></i>掃描 QR 碼
          </button>
          <label for="fileInput" class="file-input-label hover-glow">
            <i class="fas fa-image icon"></i>上傳 QR 碼
          </label>
          <input type="file" id="fileInput" accept="image/*" />
        </div>
        <div id="qr-reader" style="display: none;"></div>
        <div id="qr-result"></div>
      </form>

      <div class="form-group slide-in" style="animation-delay: 0.3s;">
        <label for="schoolOwnership">
          <i class="fas fa-building icon"></i>學校屬性：
        </label>
        <select id="schoolOwnership" class="hover-glow">
          <option value="all">全部</option>
          <option value="public">公立</option>
          <option value="private">私立</option>
        </select>
      </div>
      <div class="form-group slide-in" style="animation-delay: 0.4s;">
        <label for="schoolType">
          <i class="fas fa-graduation-cap icon"></i>學校類型：
        </label>
        <select id="schoolType" onchange="toggleVocationalGroup()" class="hover-glow">
          <option value="all">全部</option>
          <option value="普通科">普通科</option>
          <option value="職業類科">職業類科</option>
        </select>
      </div>
      <div class="form-group slide-in" id="vocationalGroupContainer" style="display: none; animation-delay: 0.5s;">
        <label for="vocationalGroup">
          <i class="fas fa-tools icon"></i>職業群別 (可複選)：
        </label>
        <button type="button" id="vocationalSelectBtn" class="vocational-select-btn hover-glow">
          <i class="fas fa-list-ul"></i> 選擇職業群別 <span id="selectedVocationalGroups" class="selected-vocational-groups">（未選擇）</span>
        </button>
        <select id="vocationalGroup" style="display: none;">
          <option value="all">全部</option>
        </select>
      </div>
      <div class="form-group slide-in" style="animation-delay: 0.6s;">
        <label>
          <i class="fas fa-user icon"></i> 分析身份：
        </label>
        <div class="identity-selector">
          <div class="identity-option">
            <input type="radio" id="identity-student" name="identitySelector" value="student" class="identity-input" onchange="toggleIdentitySelector()">
            <label for="identity-student" class="identity-label">
              <i class="fas fa-user-graduate identity-icon"></i>
              <div class="identity-name">學生</div>
            </label>
          </div>
          <div class="identity-option">
            <input type="radio" id="identity-teacher" name="identitySelector" value="teacher" class="identity-input" onchange="toggleIdentitySelector()">
            <label for="identity-teacher" class="identity-label">
              <i class="fas fa-chalkboard-teacher identity-icon"></i>
              <div class="identity-name">老師</div>
            </label>
          </div>
          <div class="identity-option">
            <input type="radio" id="identity-parent" name="identitySelector" value="parent" class="identity-input" onchange="toggleIdentitySelector()">
            <label for="identity-parent" class="identity-label">
              <i class="fas fa-user-friends identity-icon"></i>
              <div class="identity-name">家長</div>
            </label>
          </div>
        </div>
        <select id="analysisIdentity" style="display: none;">
          <option value="">請選擇身份</option>
          <option value="student">學生</option>
          <option value="teacher">老師</option>
          <option value="parent">家長</option>
        </select>
      </div>

      <div class="form-group slide-in" style="animation-delay: 0.7s;">
        <label>
          <i class="fas fa-map-marker-alt icon"></i> 分析區域：
        </label>
        <button type="button" id="regionSelectBtn" class="region-select-btn hover-glow">
          <i class="fas fa-map-marked-alt"></i> 選擇分析區域 <span id="selectedRegionName" class="selected-region">（未選擇）</span>
        </button>
        <input type="hidden" id="selectedRegionValue" name="selectedRegion" value="">
        
        <!-- 計分方式顯示區域 -->
        <div id="scoringInfo" class="scoring-info">
          <div class="scoring-info-title">
            <i class="fas fa-calculator"></i> <span id="scoringRegionName"></span> 計分方式
          </div>
          <div id="scoringContent">
            <div class="loading-spinner"></div> 正在載入計分方式...
          </div>
          <div class="scoring-details" id="scoringDetails" style="display: none;">
            <!-- 計分詳情將由JavaScript動態生成 -->
          </div>
        </div>
      </div>
      <div class="form-group slide-in" style="animation-delay: 0.8s;">
        <label for="chinese">
          <i class="fas fa-book icon"></i>國文：
        </label>
        <select id="chinese" class="hover-glow">
          <option value="">請選擇您的國文會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group slide-in" style="animation-delay: 0.9s;">
        <label for="english">
          <i class="fas fa-language icon"></i>英文：
        </label>
        <select id="english" class="hover-glow">
          <option value="">請選擇您的英文會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group slide-in" style="animation-delay: 1s;">
        <label for="math">
          <i class="fas fa-calculator icon"></i>數學：
        </label>
        <select id="math" class="hover-glow">
          <option value="">請選擇您的數學會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group slide-in" style="animation-delay: 1.1s;">
        <label for="science">
          <i class="fas fa-flask icon"></i>自然：
        </label>
        <select id="science" class="hover-glow">
          <option value="">請選擇您的自然會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group slide-in" style="animation-delay: 1.2s;">
        <label for="social">
          <i class="fas fa-globe icon"></i>社會：
        </label>
        <select id="social" class="hover-glow">
          <option value="">請選擇您的社會會考分數</option>
          <option value="A++">A++</option>
          <option value="A+">A+</option>
          <option value="A">A</option>
          <option value="B++">B++</option>
          <option value="B+">B+</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="form-group slide-in" style="animation-delay: 1.3s;">
        <label for="composition">
          <i class="fas fa-pen-nib icon"></i>作文：
        </label>
        <select id="composition" class="hover-glow">
          <option value="">請選擇您的作文會考分數</option>
          <option value="0">0 級分</option>
          <option value="1">1 級分</option>
          <option value="2">2 級分</option>
          <option value="3">3 級分</option>
          <option value="4">4 級分</option>
          <option value="5">5 級分</option>
          <option value="6">6 級分</option>
        </select>
      </div>
      <button type="button" id="analyzeButton" class="slide-in hover-glow" style="animation-delay: 1.4s;" onclick="analyzeScores()">
        <i class="fas fa-search icon"></i>分析落點
      </button>
      <button id="exportResults" class="slide-in hover-glow" style="display: none; animation-delay: 1.5s;" onclick="exportResults()">
        <i class="fas fa-file-export icon"></i>匯出結果
      </button>
      <div id="results"></div>

      <div id="ratingSection" class="slide-in" style="animation-delay: 1.6s;">
        <h2><i class="fas fa-star icon"></i> 為我們評分</h2>
        <div id="starsContainer">
          <span class="star" data-value="1">&#9733;</span>
          <span class="star" data-value="2">&#9733;</span>
          <span class="star" data-value="3">&#9733;</span>
          <span class="star" data-value="4">&#9733;</span>
          <span class="star" data-value="5">&#9733;</span>
        </div>
        <button id="submitRating" class="rating-button hover-glow">
          <i class="fas fa-paper-plane icon"></i> 提交評分
        </button>
        <div id="ratingMessage" style="display: none; margin-top: 10px;"></div>
      </div>

      <div class="copyright slide-in" style="animation-delay: 1.7s;">
        &copy; <span id="currentYear"></span> 會考落點分析系統. All rights reserved.
        <p>本網站由會考落點分析平台開發維護。未經授權，禁止複製或轉載。</p>
      </div>
    </div>

    <button id="darkModeToggle" class="dark-mode-toggle hover-glow" aria-label="切換深色模式">
      <i class="fas fa-moon"></i>
    </button>

    <!-- 區域選擇彈窗 -->
    <div id="regionModal" class="modal">
      <div class="region-modal-content">
        <div class="region-modal-header">
          <h2 class="region-modal-title"><i class="fas fa-map-marker-alt"></i> 選擇分析區域</h2>
          <button class="new-close-button" onclick="closeRegionModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="region-selector">
          <!-- 已開放區域分類標題 -->
          <div class="region-category">
            <i class="fas fa-check-circle"></i> 已開放區域
          </div>
          
          <!-- 已開放區域 -->
          <div class="region-option">
            <input type="radio" id="region-taoyuan" name="analysisArea" value="taoyuan" class="region-input" onchange="selectRegion('taoyuan', '桃聯區')">
            <label for="region-taoyuan" class="region-label">
              <div class="region-icon">
                <i class="fas fa-city"></i>
              </div>
              <div class="region-text">
                <div class="region-name">桃聯區</div>
                <div class="region-description">桃園聯合分發區考生</div>
                <div class="region-features">
                  <span class="region-feature"><i class="fas fa-school"></i> 105+ 高中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option">
            <input type="radio" id="region-taipei" name="analysisArea" value="taipei" class="region-input" onchange="selectRegion('taipei', '基北區')">
            <label for="region-taipei" class="region-label">
              <div class="region-icon">
                <i class="fas fa-city"></i>
              </div>
              <div class="region-text">
                <div class="region-name">基北區</div>
                <div class="region-description">基北區考生</div>
                <div class="region-features">
                  <span class="region-feature"><i class="fas fa-school"></i> 110+ 高中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option">
            <input type="radio" id="region-central" name="analysisArea" value="central" class="region-input" onchange="selectRegion('central', '中投區')">
            <label for="region-central" class="region-label">
              <div class="region-icon">
                <i class="fas fa-mountain"></i>
              </div>
              <div class="region-text">
                <div class="region-name">中投區</div>
                <div class="region-description">中投區考生</div>
                <div class="region-features">
                  <span class="region-feature"><i class="fas fa-school"></i> 80+ 高中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option">
            <input type="radio" id="region-changhua" name="analysisArea" value="changhua" class="region-input" onchange="selectRegion('changhua', '彰化區')">
            <label for="region-changhua" class="region-label">
              <div class="region-icon">
                <i class="fas fa-seedling"></i>
              </div>
              <div class="region-text">
                <div class="region-name">彰化區</div>
                <div class="region-description">彰化區考生</div>
                <div class="region-features">
                  <span class="region-feature"><i class="fas fa-school"></i> 60+ 高中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option">
            <input type="radio" id="region-tainan" name="analysisArea" value="tainan" class="region-input" onchange="selectRegion('tainan', '台南區')">
            <label for="region-tainan" class="region-label">
              <div class="region-icon">
                <i class="fas fa-landmark"></i>
              </div>
              <div class="region-text">
                <div class="region-name">台南區</div>
                <div class="region-description">台南區考生</div>
                <div class="region-features">
                  <span class="region-feature"><i class="fas fa-school"></i> 75+ 高中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option">
            <input type="radio" id="region-kaohsiung" name="analysisArea" value="kaohsiung" class="region-input" onchange="selectRegion('kaohsiung', '高雄區')">
            <label for="region-kaohsiung" class="region-label">
              <div class="region-icon">
                <i class="fas fa-ship"></i>
              </div>
              <div class="region-text">
                <div class="region-name">高雄區</div>
                <div class="region-description">高雄區考生</div>
                <div class="region-features">
                  <span class="region-feature"><i class="fas fa-school"></i> 90+ 高中</span>
                </div>
              </div>
            </label>
          </div>
          
          <!-- 籌備中區域分類標題 -->
          <div class="region-category preparing-category">
            <i class="fas fa-tools"></i> 籌備中區域
          </div>
          
          <!-- 未開放區域 -->
          <div class="region-option disabled">
            <input type="radio" id="region-hsinchu" name="analysisArea" value="hsinchu" class="region-input" disabled>
            <label for="region-hsinchu" class="region-label">
              <div class="region-icon">
                <i class="fas fa-microchip"></i>
              </div>
              <div class="region-text">
                <div class="region-name">竹苗區</div>
                <div class="region-description">竹苗區考生</div>
                <div class="region-features">
                  <span class="region-feature preparing"><i class="fas fa-tools"></i> 正在籌備中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option disabled">
            <input type="radio" id="region-yunlin" name="analysisArea" value="yunlin" class="region-input" disabled>
            <label for="region-yunlin" class="region-label">
              <div class="region-icon">
                <i class="fas fa-warehouse"></i>
              </div>
              <div class="region-text">
                <div class="region-name">雲林區</div>
                <div class="region-description">雲林區考生</div>
                <div class="region-features">
                  <span class="region-feature preparing"><i class="fas fa-tools"></i> 正在籌備中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option disabled">
            <input type="radio" id="region-chiayi" name="analysisArea" value="chiayi" class="region-input" disabled>
            <label for="region-chiayi" class="region-label">
              <div class="region-icon">
                <i class="fas fa-tree"></i>
              </div>
              <div class="region-text">
                <div class="region-name">嘉義區</div>
                <div class="region-description">嘉義區考生</div>
                <div class="region-features">
                  <span class="region-feature preparing"><i class="fas fa-tools"></i> 正在籌備中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option disabled">
            <input type="radio" id="region-pingtung" name="analysisArea" value="pingtung" class="region-input" disabled>
            <label for="region-pingtung" class="region-label">
              <div class="region-icon">
                <i class="fas fa-umbrella-beach"></i>
              </div>
              <div class="region-text">
                <div class="region-name">屏東區</div>
                <div class="region-description">屏東區考生</div>
                <div class="region-features">
                  <span class="region-feature preparing"><i class="fas fa-tools"></i> 正在籌備中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option disabled">
            <input type="radio" id="region-yilan" name="analysisArea" value="yilan" class="region-input" disabled>
            <label for="region-yilan" class="region-label">
              <div class="region-icon">
                <i class="fas fa-spa"></i>
              </div>
              <div class="region-text">
                <div class="region-name">宜蘭區</div>
                <div class="region-description">宜蘭區考生</div>
                <div class="region-features">
                  <span class="region-feature preparing"><i class="fas fa-tools"></i> 正在籌備中</span>
                </div>
              </div>
            </label>
          </div>
          
          <div class="region-option disabled">
            <input type="radio" id="region-hualien" name="analysisArea" value="hualien" class="region-input" disabled>
            <label for="region-hualien" class="region-label">
              <div class="region-icon">
                <i class="fas fa-mountain"></i>
              </div>
              <div class="region-text">
                <div class="region-name">花蓮區</div>
                <div class="region-description">花蓮區考生</div>
                <div class="region-features">
                  <span class="region-feature preparing"><i class="fas fa-tools"></i> 正在籌備中</span>
                </div>
              </div>
            </label>
          </div>
        </div>
      </div>
    </div>

    <div id="disclaimerModal" class="modal">
      <div class="modal-content">
        <button class="new-close-button" onclick="closeDisclaimer()">
          <i class="fas fa-times"></i>
        </button>
        <h2>
          <i class="fas fa-balance-scale icon"></i> 免責聲明
        </h2>
        <a href="https://forms.gle/e5tHU1haqpHRU7nJ9" target="_blank" class="hover-glow">
          <i class="fas fa-link icon"></i> 填寫表單獲取邀請碼
        </a>
        <p>
          <i class="fas fa-info-circle icon"></i> 親愛的使用者，我們誠摯地提醒您：本網站提供的落點分析結果僅供參考，不代表實際錄取結果。實際錄取情況可能會因多種因素而有所不同，包括但不限於：
        </p>
        <ul>
          <li class="slide-in" style="animation-delay: 0.2s;">
            <i class="fas fa-university icon"></i> 各校的招生政策變化
          </li>
          <li class="slide-in" style="animation-delay: 0.3s;">
            <i class="fas fa-users icon"></i> 當年度考生整體表現
          </li>
          <li class="slide-in" style="animation-delay: 0.4s;">
            <i class="fas fa-star icon"></i> 特殊才能或其他加分項目
          </li>
          <li class="slide-in" style="animation-delay: 0.5s;">
            <i class="fas fa-clipboard-list icon"></i> 各校的實際招生名額調整
          </li>
        </ul>
        <p>
          <i class="fas fa-exclamation-triangle icon"></i> 為了確保您做出最佳的決定，我們強烈建議您：
        </p>
        <ul>
          <li class="slide-in" style="animation-delay: 0.6s;">
            <i class="fas fa-search icon"></i> 參考多方資訊，不要僅依賴本網站的分析結果
          </li>
          <li class="slide-in" style="animation-delay: 0.7s;">
            <i class="fas fa-comments icon"></i> 諮詢學校輔導老師或升學顧問的專業意見
          </li>
          <li class="slide-in" style="animation-delay: 0.8s;">
            <i class="fas fa-globe icon"></i> 密切關注各校的官方網站和招生簡章，以獲取最新和最準確的資訊
          </li>
        </ul>
        <p>
          <i class="fas fa-shield-alt icon"></i> 本網站不對因使用本服務而產生的任何直接或間接損失負責。使用本服務即表示您同意本免責聲明的所有條款。祝您升學順利！
        </p>
        <button class="confirm-button hover-glow" onclick="closeDisclaimer()">
          <i class="fas fa-check-circle icon"></i> 我已了解並同意
        </button>
      </div>
    </div>

    <div id="instructionsModal" class="modal">
      <div class="modal-content instructions-modal-content">
        <button class="new-close-button" onclick="closeInstructions()">
          <i class="fas fa-times"></i>
        </button>
        <h2>
          <i class="fas fa-book icon"></i>使用說明
        </h2>
        
        <div class="mobile-guide-notice">
          <i class="fas fa-info-circle"></i> 滑動屏幕查看更多內容
        </div>
        
        <div class="mobile-instruction-note">
          <i class="fas fa-hand-point-up"></i> 點擊步驟標籤或使用下一步按鈕切換內容
        </div>
        
        <div class="nav-helper-tip">
          <i class="fas fa-arrow-down"></i> 向下滑動查看更多，底部有導航按鈕
        </div>
        
        <div class="instructions-guide">
          <div class="instructions-steps">
            <div class="instruction-step active" data-step="1">
              <div class="step-number">1</div>
              <div class="step-title">獲取邀請碼</div>
            </div>
            <div class="instruction-step" data-step="2">
              <div class="step-number">2</div>
              <div class="step-title">輸入基本資料</div>
            </div>
            <div class="instruction-step" data-step="3">
              <div class="step-number">3</div>
              <div class="step-title">填寫會考成績</div>
            </div>
            <div class="instruction-step" data-step="4">
              <div class="step-number">4</div>
              <div class="step-title">分析落點結果</div>
            </div>
            <div class="instruction-step" data-step="5">
              <div class="step-number">5</div>
              <div class="step-title">匯出與比較</div>
            </div>
          </div>
          
          <div class="instructions-content">
            <div class="instruction-panel active" data-panel="1">
              <h3><i class="fas fa-key icon"></i> 獲取並輸入邀請碼</h3>
              <div class="instruction-panel-content">
                <div class="instruction-visual">
                  <i class="fas fa-qrcode icon-large"></i>
                  <div>邀請碼每小時更新一次，請確保使用最新的邀請碼</div>
                </div>
                <p>您可以通過以下方式獲取邀請碼：</p>
                <div class="instruction-methods">
                  <div class="instruction-method">
                    <i class="fas fa-file-alt"></i>
                    <span>填寫序位回報表單</span>
                  </div>
                  <div class="instruction-method">
                    <i class="fas fa-camera"></i>
                    <span>掃描 QR 碼</span>
                  </div>
                  <div class="instruction-method">
                    <i class="fas fa-image"></i>
                    <span>上傳 QR 碼圖片</span>
                  </div>
                </div>
                <div class="instruction-tip">
                  <i class="fas fa-lightbulb"></i>
                  <span>點擊首頁的「填寫表單獲取邀請碼」按鈕可立即獲取最新邀請碼</span>
                </div>
              </div>
              <div class="instruction-nav">
                <button disabled class="nav-btn prev-btn">
                  <i class="fas fa-chevron-left"></i> 上一步
                </button>
                <div class="mobile-panel-indicator">
                  <span class="indicator-dot active" data-dot="1"></span>
                  <span class="indicator-dot" data-dot="2"></span>
                  <span class="indicator-dot" data-dot="3"></span>
                  <span class="indicator-dot" data-dot="4"></span>
                  <span class="indicator-dot" data-dot="5"></span>
                </div>
                <button class="nav-btn next-btn" onclick="changeInstructionPanel(2)">
                  下一步 <i class="fas fa-chevron-right"></i>
                </button>
              </div>
            </div>

            <div class="instruction-panel" data-panel="2">
              <h3><i class="fas fa-filter icon"></i> 輸入基本資料</h3>
              <div class="instruction-panel-content">
                <p>請選擇以下篩選條件，以獲得更精確的分析結果：</p>
                <div class="instruction-criteria">
                  <div class="criteria-item">
                    <div class="criteria-icon"><i class="fas fa-building"></i></div>
                    <div class="criteria-info">
                      <h4>學校屬性</h4>
                      <p>全部、公立或私立</p>
                    </div>
                  </div>
                  <div class="criteria-item">
                    <div class="criteria-icon"><i class="fas fa-graduation-cap"></i></div>
                    <div class="criteria-info">
                      <h4>學校類型</h4>
                      <p>全部、普通科或職業類科</p>
                    </div>
                  </div>
                  <div class="criteria-item">
                    <div class="criteria-icon"><i class="fas fa-tools"></i></div>
                    <div class="criteria-info">
                      <h4>職業群別</h4>
                      <p>選擇特定職業群或全部（僅限職業類科）</p>
                    </div>
                  </div>
                  <div class="criteria-item">
                    <div class="criteria-icon"><i class="fas fa-user-graduate"></i></div>
                    <div class="criteria-info">
                      <h4>分析身份</h4>
                      <p>學生、老師或家長</p>
                    </div>
                  </div>
                  <div class="criteria-item">
                    <div class="criteria-icon"><i class="fas fa-map-marker-alt"></i></div>
                    <div class="criteria-info">
                      <h4>分析區域</h4>
                      <p>桃聯區、中投區、高雄區或彰化區</p>
                    </div>
                  </div>
                </div>
                <div class="instruction-tip">
                  <i class="fas fa-exclamation-circle"></i>
                  <span>不同地區有不同的計分方式，請務必選擇正確的區域</span>
                </div>
              </div>
              <div class="instruction-nav">
                <button class="nav-btn prev-btn" onclick="changeInstructionPanel(1)">
                  <i class="fas fa-chevron-left"></i> 上一步
                </button>
                <div class="mobile-panel-indicator">
                  <span class="indicator-dot" data-dot="1"></span>
                  <span class="indicator-dot active" data-dot="2"></span>
                  <span class="indicator-dot" data-dot="3"></span>
                  <span class="indicator-dot" data-dot="4"></span>
                  <span class="indicator-dot" data-dot="5"></span>
                </div>
                <button class="nav-btn next-btn" onclick="changeInstructionPanel(3)">
                  下一步 <i class="fas fa-chevron-right"></i>
                </button>
              </div>
            </div>

            <div class="instruction-panel" data-panel="3">
              <h3><i class="fas fa-pencil-alt icon"></i> 填寫會考成績</h3>
              <div class="instruction-panel-content">
                <div class="instruction-scores">
                  <div class="instruction-visual">
                    <i class="fas fa-award icon-large"></i>
                    <div>請確保填寫所有科目的成績，否則無法進行分析</div>
                  </div>
                  <div class="grade-card">
                    <div class="grade-header">會考成績等級表</div>
                    <div class="grade-body">
                      <div class="grade-row"><span>等級</span><span>會考</span><span>PR值</span></div>
                      <div class="grade-row grade-excellent"><span>A++</span><span>精熟</span><span>頂標</span></div>
                      <div class="grade-row grade-great"><span>A+</span><span>精熟</span><span>前標</span></div>
                      <div class="grade-row grade-good"><span>A</span><span>精熟</span><span>均標</span></div>
                      <div class="grade-row grade-above-average"><span>B++</span><span>基礎</span><span>後標</span></div>
                      <div class="grade-row grade-average"><span>B+</span><span>基礎</span><span>底標</span></div>
                      <div class="grade-row grade-below-average"><span>B</span><span>基礎</span><span>基礎</span></div>
                      <div class="grade-row grade-needs-improvement"><span>C</span><span>待加強</span><span>待加強</span></div>
                    </div>
                  </div>
                  <div class="score-items">
                    <div class="score-item"><i class="fas fa-book"></i> 國文：A++ 到 C</div>
                    <div class="score-item"><i class="fas fa-language"></i> 英文：A++ 到 C</div>
                    <div class="score-item"><i class="fas fa-calculator"></i> 數學：A++ 到 C</div>
                    <div class="score-item"><i class="fas fa-flask"></i> 自然：A++ 到 C</div>
                    <div class="score-item"><i class="fas fa-globe"></i> 社會：A++ 到 C</div>
                    <div class="score-item"><i class="fas fa-pen-nib"></i> 作文：0 到 6 級分</div>
                  </div>
                </div>
              </div>
              <div class="instruction-nav">
                <button class="nav-btn prev-btn" onclick="changeInstructionPanel(2)">
                  <i class="fas fa-chevron-left"></i> 上一步
                </button>
                <div class="mobile-panel-indicator">
                  <span class="indicator-dot" data-dot="1"></span>
                  <span class="indicator-dot" data-dot="2"></span>
                  <span class="indicator-dot active" data-dot="3"></span>
                  <span class="indicator-dot" data-dot="4"></span>
                  <span class="indicator-dot" data-dot="5"></span>
                </div>
                <button class="nav-btn next-btn" onclick="changeInstructionPanel(4)">
                  下一步 <i class="fas fa-chevron-right"></i>
                </button>
              </div>
            </div>

            <div class="instruction-panel" data-panel="4">
              <h3><i class="fas fa-chart-line icon"></i> 分析落點結果</h3>
              <div class="instruction-panel-content">
                <div class="analysis-preview">
                  <div class="analysis-item">
                    <div class="analysis-icon">
                      <i class="fas fa-star"></i>
                    </div>
                    <div class="analysis-info">
                      <h4>總積分計算結果</h4>
                      <p>系統會根據您選擇的區域計算出總積分</p>
                    </div>
                  </div>
                  <div class="analysis-item">
                    <div class="analysis-icon">
                      <i class="fas fa-award"></i>
                    </div>
                    <div class="analysis-info">
                      <h4>總積點計算結果</h4>
                      <p>根據各區域的特定計分方式計算積點</p>
                    </div>
                  </div>
                  <div class="analysis-item">
                    <div class="analysis-icon">
                      <i class="fas fa-school"></i>
                    </div>
                    <div class="analysis-info">
                      <h4>符合條件的學校列表</h4>
                      <p>顯示所有符合您條件和成績的學校</p>
                    </div>
                  </div>
                  <div class="analysis-item">
                    <div class="analysis-icon">
                      <i class="fas fa-chart-pie"></i>
                    </div>
                    <div class="analysis-info">
                      <h4>學校分類統計</h4>
                      <p>各類型學校的數量與比例</p>
                    </div>
                  </div>
                </div>
                <div class="instruction-tip">
                  <i class="fas fa-lightbulb"></i>
                  <span>點選學校名稱可查看更詳細的學校資訊</span>
                </div>
              </div>
              <div class="instruction-nav">
                <button class="nav-btn prev-btn" onclick="changeInstructionPanel(3)">
                  <i class="fas fa-chevron-left"></i> 上一步
                </button>
                <div class="mobile-panel-indicator">
                  <span class="indicator-dot" data-dot="1"></span>
                  <span class="indicator-dot" data-dot="2"></span>
                  <span class="indicator-dot" data-dot="3"></span>
                  <span class="indicator-dot active" data-dot="4"></span>
                  <span class="indicator-dot" data-dot="5"></span>
                </div>
                <button class="nav-btn next-btn" onclick="changeInstructionPanel(5)">
                  下一步 <i class="fas fa-chevron-right"></i>
                </button>
              </div>
            </div>

            <div class="instruction-panel" data-panel="5">
              <h3><i class="fas fa-file-export icon"></i> 匯出與比較</h3>
              <div class="instruction-panel-content">
                <p>您可以將分析結果匯出為多種格式，或進行學校比較：</p>
                <div class="export-options">
                  <div class="export-option">
                    <i class="fas fa-file-alt"></i>
                    <span>文字檔 (.txt)</span>
                    <small>簡單易讀的純文字格式</small>
                  </div>
                  <div class="export-option">
                    <i class="fas fa-file-pdf"></i>
                    <span>PDF檔 (.pdf)</span>
                    <small>適合列印或正式保存</small>
                  </div>
                  <div class="export-option">
                    <i class="fas fa-file-excel"></i>
                    <span>Excel檔 (.xlsx)</span>
                    <small>可在電子表格軟體中開啟</small>
                  </div>
                  <div class="export-option">
                    <i class="fas fa-file-code"></i>
                    <span>JSON檔 (.json)</span>
                    <small>適合程式開發者使用</small>
                  </div>
                  <div class="export-option">
                    <i class="fas fa-print"></i>
                    <span>直接列印</span>
                    <small>使用瀏覽器列印功能輸出結果</small>
                  </div>
                </div>
                <div class="comparison-feature">
                  <h4><i class="fas fa-exchange-alt"></i> 學校比較功能</h4>
                  <p>將感興趣的學校加入比較清單，系統會生成詳細的比較表格，協助您做出更明智的選擇。</p>
                </div>
                <div class="instruction-tip">
                  <i class="fas fa-info-circle"></i>
                  <span>分析結果僅供參考，請務必與學校官方招生簡章核對</span>
                </div>
              </div>
              <div class="instruction-nav">
                <button class="nav-btn prev-btn" onclick="changeInstructionPanel(4)">
                  <i class="fas fa-chevron-left"></i> 上一步
                </button>
                <div class="mobile-panel-indicator">
                  <span class="indicator-dot" data-dot="1"></span>
                  <span class="indicator-dot" data-dot="2"></span>
                  <span class="indicator-dot" data-dot="3"></span>
                  <span class="indicator-dot" data-dot="4"></span>
                  <span class="indicator-dot active" data-dot="5"></span>
                </div>
                <button class="nav-btn next-btn" onclick="closeInstructions()">
                  開始使用 <i class="fas fa-check"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 職業群別選擇彈窗 -->
    <div id="vocationalGroupModal" class="modal">
      <div class="vocational-modal-content">
        <div class="vocational-modal-header">
          <h2 class="vocational-modal-title"><i class="fas fa-tools"></i> 選擇職業群別</h2>
          <button class="new-close-button" onclick="closeVocationalModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="vocational-group-container">
          <div class="vocational-group-option">
            <input type="checkbox" id="groupAll" class="vocational-group-input" value="all" checked onclick="toggleAllVocationalGroups()">
            <label for="groupAll" class="vocational-group-label">
              <i class="fas fa-check-circle"></i>
              <span>全部選擇</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupMechanical" class="vocational-group-input" value="機械群" onclick="updateVocationalGroupsSelection()">
            <label for="groupMechanical" class="vocational-group-label">
              <i class="fas fa-cogs"></i>
              <span>機械群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupPower" class="vocational-group-input" value="動力機械群" onclick="updateVocationalGroupsSelection()">
            <label for="groupPower" class="vocational-group-label">
              <i class="fas fa-car"></i>
              <span>動力機械群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupElectrical" class="vocational-group-input" value="電機與電子群" onclick="updateVocationalGroupsSelection()">
            <label for="groupElectrical" class="vocational-group-label">
              <i class="fas fa-bolt"></i>
              <span>電機與電子群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupChemical" class="vocational-group-input" value="化工群" onclick="updateVocationalGroupsSelection()">
            <label for="groupChemical" class="vocational-group-label">
              <i class="fas fa-flask"></i>
              <span>化工群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupCivil" class="vocational-group-input" value="土木與建築群" onclick="updateVocationalGroupsSelection()">
            <label for="groupCivil" class="vocational-group-label">
              <i class="fas fa-building"></i>
              <span>土木與建築群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupBusiness" class="vocational-group-input" value="商業與管理群" onclick="updateVocationalGroupsSelection()">
            <label for="groupBusiness" class="vocational-group-label">
              <i class="fas fa-briefcase"></i>
              <span>商業與管理群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupForeign" class="vocational-group-input" value="外語群" onclick="updateVocationalGroupsSelection()">
            <label for="groupForeign" class="vocational-group-label">
              <i class="fas fa-language"></i>
              <span>外語群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupDesign" class="vocational-group-input" value="設計群" onclick="updateVocationalGroupsSelection()">
            <label for="groupDesign" class="vocational-group-label">
              <i class="fas fa-palette"></i>
              <span>設計群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupAgriculture" class="vocational-group-input" value="農業群" onclick="updateVocationalGroupsSelection()">
            <label for="groupAgriculture" class="vocational-group-label">
              <i class="fas fa-leaf"></i>
              <span>農業群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupFood" class="vocational-group-input" value="食品群" onclick="updateVocationalGroupsSelection()">
            <label for="groupFood" class="vocational-group-label">
              <i class="fas fa-utensils"></i>
              <span>食品群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupHomEc" class="vocational-group-input" value="家政群" onclick="updateVocationalGroupsSelection()">
            <label for="groupHomEc" class="vocational-group-label">
              <i class="fas fa-home"></i>
              <span>家政群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupHospitality" class="vocational-group-input" value="餐旅群" onclick="updateVocationalGroupsSelection()">
            <label for="groupHospitality" class="vocational-group-label">
              <i class="fas fa-concierge-bell"></i>
              <span>餐旅群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupAquaFishery" class="vocational-group-input" value="水產群" onclick="updateVocationalGroupsSelection()">
            <label for="groupAquaFishery" class="vocational-group-label">
              <i class="fas fa-fish"></i>
              <span>水產群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupMarine" class="vocational-group-input" value="海事群" onclick="updateVocationalGroupsSelection()">
            <label for="groupMarine" class="vocational-group-label">
              <i class="fas fa-ship"></i>
              <span>海事群</span>
            </label>
          </div>
          <div class="vocational-group-option">
            <input type="checkbox" id="groupArt" class="vocational-group-input" value="藝術群" onclick="updateVocationalGroupsSelection()">
            <label for="groupArt" class="vocational-group-label">
              <i class="fas fa-paint-brush"></i>
              <span>藝術群</span>
            </label>
          </div>
        </div>
        <div class="modal-footer">
          <button class="confirm-button hover-glow" onclick="confirmVocationalGroups()">
            <i class="fas fa-check-circle icon"></i> 確認選擇
          </button>
        </div>
      </div>
    </div>

    <div id="changeLogModal" class="modal">
      <div class="modal-content changelog-modal-content">
        <button class="new-close-button" onclick="closeChangeLog()">
          <i class="fas fa-times"></i>
        </button>
        <h2>
          <i class="fas fa-history icon"></i> 更新日誌
        </h2>
        
        <div class="changelog-container">
          <div class="changelog-entry">
            <div class="changelog-version">版本 2.0</div>
            <div class="changelog-date">2024 年 5 月 10 日</div>
            <div class="changelog-changes">
              <ul>
                <li class="slide-in" style="animation-delay: 0.1s;">
                  <i class="fas fa-star icon"></i> <strong>全新區域選擇功能</strong>：新增彰化區、基北區及台南區支援
                </li>
                <li class="slide-in" style="animation-delay: 0.2s;">
                  <i class="fas fa-tools icon"></i> <strong>職業群別篩選</strong>：新增職業群別多選功能
                </li>
                <li class="slide-in" style="animation-delay: 0.3s;">
                  <i class="fas fa-calculator icon"></i> <strong>計分方式顯示</strong>：各區域計分方式即時顯示
                </li>
                <li class="slide-in" style="animation-delay: 0.4s;">
                  <i class="fas fa-mobile-alt icon"></i> <strong>行動裝置優化</strong>：改善手機和平板的使用體驗
                </li>
                <li class="slide-in" style="animation-delay: 0.5s;">
                  <i class="fas fa-moon icon"></i> <strong>深色模式</strong>：新增深色模式支援
                </li>
              </ul>
            </div>
          </div>
          
          <div class="changelog-entry">
            <div class="changelog-version">版本 1.5</div>
            <div class="changelog-date">2024 年 2 月 15 日</div>
            <div class="changelog-changes">
              <ul>
                <li class="slide-in" style="animation-delay: 0.6s;">
                  <i class="fas fa-file-export icon"></i> <strong>匯出功能升級</strong>：新增 PDF 及 Excel 匯出選項
                </li>
                <li class="slide-in" style="animation-delay: 0.7s;">
                  <i class="fas fa-database icon"></i> <strong>資料庫更新</strong>：更新最新學校資訊及錄取標準
                </li>
                <li class="slide-in" style="animation-delay: 0.8s;">
                  <i class="fas fa-bug icon"></i> <strong>錯誤修復</strong>：修復多項系統穩定性問題
                </li>
              </ul>
            </div>
          </div>
          
          <div class="changelog-entry">
            <div class="changelog-version">版本 1.0</div>
            <div class="changelog-date">2023 年 10 月 20 日</div>
            <div class="changelog-changes">
              <ul>
                <li class="slide-in" style="animation-delay: 0.9s;">
                  <i class="fas fa-rocket icon"></i> <strong>系統啟動</strong>：會考落點分析系統正式上線
                </li>
                <li class="slide-in" style="animation-delay: 1.0s;">
                  <i class="fas fa-map-marked-alt icon"></i> <strong>初始區域支援</strong>：支援桃聯區、中投區及高雄區
                </li>
                <li class="slide-in" style="animation-delay: 1.1s;">
                  <i class="fas fa-user-shield icon"></i> <strong>邀請碼系統</strong>：實施邀請碼機制確保系統穩定
                </li>
              </ul>
            </div>
          </div>
        </div>
        
        <button class="confirm-button hover-glow" onclick="closeChangeLog()">
          <i class="fas fa-check-circle icon"></i> 關閉
        </button>
      </div>
    </div>

    <script src="script.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H9X7EC127P"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H9X7EC127P');
</script>

<!-- 新增區域彈窗選擇JavaScript函數 -->
<script>
  // 打開區域選擇彈窗
  document.getElementById('regionSelectBtn').addEventListener('click', function() {
    document.getElementById('regionModal').style.display = 'block';
    document.body.style.overflow = 'hidden'; // 防止背景滾動
  });

  // 關閉區域選擇彈窗
  function closeRegionModal() {
    document.getElementById('regionModal').style.display = 'none';
    document.body.style.overflow = 'auto'; // 恢復背景滾動
  }

  // 當用戶點擊彈窗外的區域時關閉彈窗
  window.addEventListener('click', function(event) {
    if (event.target == document.getElementById('regionModal')) {
      closeRegionModal();
    }
  });

  // 選擇區域
  function selectRegion(value, name) {
    document.getElementById('selectedRegionValue').value = value;
    document.getElementById('selectedRegionName').textContent = name;
    closeRegionModal();
    
    // 顯示計分方式
    showScoringInfo(value, name);
  }
  
  // 查詢並顯示計分方式
  function showScoringInfo(region, regionName) {
    const scoringInfo = document.getElementById('scoringInfo');
    const scoringContent = document.getElementById('scoringContent');
    const scoringDetails = document.getElementById('scoringDetails');
    const scoringRegionName = document.getElementById('scoringRegionName');
    
    // 顯示載入狀態
    scoringInfo.classList.add('active');
    scoringRegionName.textContent = regionName;
    scoringDetails.style.display = 'none';
    scoringContent.innerHTML = '<div class="loading-spinner"></div> 正在載入計分方式...';
    
    // 模擬後端API請求
    setTimeout(() => {
      const scoringData = getScoringMethod(region);
      
      if (scoringData) {
        // 清空載入訊息
        scoringContent.innerHTML = scoringData.description;
        
        // 構建計分詳情
        let detailsHTML = '';
        scoringData.details.forEach(item => {
          detailsHTML += `
            <div class="scoring-item">
              <div class="scoring-item-header">
                <i class="fas ${item.icon}"></i> ${item.title}
              </div>
              <div class="scoring-item-value">${item.value}</div>
            </div>
          `;
        });
        
        scoringDetails.innerHTML = detailsHTML;
        scoringDetails.style.display = 'grid';
      } else {
        scoringContent.innerHTML = '<i class="fas fa-exclamation-circle"></i> 無法獲取該區域計分方式信息';
      }
    }, 800); // 模擬網絡延遲
  }
  
  // 獲取不同區域的計分方式
  function getScoringMethod(region) {
    const scoringMethods = {
      'taoyuan': {
        description: '桃聯區採用五科等級轉換積分制，並考慮作文級分，同時計算積點總和用於同分比序。',
        details: [
          { title: '分數轉換', value: 'A++/A+/A: 6分，B++/B+/B: 4分，C: 2分', icon: 'fa-star' },
          { title: '作文換算', value: '0級: 0分, 1級: 1分, 2-3級: 2分, 4-6級: 3分', icon: 'fa-pen-nib' },
          { title: '積點計算', value: 'A++: 7點, A+: 6點, A: 5點, B++: 4點, B+: 3點, B: 2點, C: 1點', icon: 'fa-calculator' },
          { title: '錄取依據', value: '主要看總分，同分則比總積點', icon: 'fa-sort-amount-up' }
        ]
      },
      'central': {
        description: '中投區採用五科積分制，並將作文級分納入積點計算用於同分比序。',
        details: [
          { title: '分數轉換', value: 'A++/A+/A: 6分，B++/B+/B: 4分，C: 2分', icon: 'fa-star' },
          { title: '積點計算', value: 'A++: 21點, A+: 18點, A: 15點, B++: 12點, B+: 9點, B: 6點, C: 3點', icon: 'fa-calculator' },
          { title: '作文積點', value: '作文級分直接轉換為積點(0-6點)', icon: 'fa-pen-nib' },
          { title: '錄取依據', value: '主要看總分，同分則比總積點', icon: 'fa-sort-amount-up' }
        ]
      },
      'kaohsiung': {
        description: '高雄區計分方式採用五科積分總和，作文不計入總分但計入積點用於同分比序。',
        details: [
          { title: '分數轉換', value: 'A++/A+/A: 6分，B++/B+/B: 4分，C: 2分', icon: 'fa-star' },
          { title: '積點計算', value: 'A++: 7點, A+: 6點, A: 5點, B++: 4點, B+: 3點, B: 2點, C: 1點', icon: 'fa-calculator' },
          { title: '作文影響', value: '不計入總分，僅計入積點', icon: 'fa-pen-nib' },
          { title: '錄取依據', value: '主要看總分，同分則比總積點', icon: 'fa-sort-amount-up' }
        ]
      },
      'changhua': {
        description: '彰化區直接使用五科原始等級分數加總，採用更細緻的分級計分方式。',
        details: [
          { title: '分數轉換', value: 'A++: 9分, A+: 8分, A: 7分, B++: 6分, B+: 5分, B: 4分, C: 3分', icon: 'fa-star' },
          { title: '計分方式', value: '五科分數直接相加', icon: 'fa-plus' },
          { title: '作文影響', value: '不計入總分', icon: 'fa-pen-nib' },
          { title: '錄取依據', value: '僅看總分', icon: 'fa-sort-amount-up' }
        ]
      },
      'taipei': {
        description: '基北區採用五科等級積分制與作文級分加權計算，積分轉換更細緻。',
        details: [
          { title: '科目積分', value: 'A++: 7分, A+: 6分, A: 5分, B++: 4分, B+: 3分, B: 2分, C: 1分', icon: 'fa-star' },
          { title: '作文積分', value: '6級: 1分, 5級: 0.8分, 4級: 0.6分, 3級: 0.4分, 2級: 0.2分, 1級: 0.1分', icon: 'fa-pen-nib' },
          { title: '計分方式', value: '五科積分相加再加上作文積分', icon: 'fa-plus' },
          { title: '區域說明', value: '臺北市、新北市、基隆市考生', icon: 'fa-info-circle' }
        ]
      },
      'hsinchu': {
        description: '竹苗區正在籌備中，預計將採用五科積分及作文級分計算方式。',
        details: [
          { title: '主要依據', value: '籌備中', icon: 'fa-tools' },
          { title: '預計上線', value: '2025年4月', icon: 'fa-calendar-alt' }
        ]
      },
      'yunlin': {
        description: '雲林區正在籌備中，計分方式尚在設計階段。',
        details: [
          { title: '主要依據', value: '籌備中', icon: 'fa-tools' },
          { title: '預計上線', value: '2025年5月', icon: 'fa-calendar-alt' }
        ]
      },
      'chiayi': {
        description: '嘉義區正在籌備中，計分方式尚在設計階段。',
        details: [
          { title: '主要依據', value: '籌備中', icon: 'fa-tools' },
          { title: '預計上線', value: '2025年5月', icon: 'fa-calendar-alt' }
        ]
      },
      'tainan': {
        description: '台南區採用五科等級積分制與作文級分加權計算，積分轉換更細緻。',
        details: [
          { title: '科目積分', value: 'A++: 7分, A+: 6分, A: 5分, B++: 4分, B+: 3分, B: 2分, C: 1分', icon: 'fa-star' },
          { title: '作文積分', value: '6級: 1分, 5級: 0.8分, 4級: 0.6分, 3級: 0.4分, 2級: 0.2分, 1級: 0.1分', icon: 'fa-pen-nib' },
          { title: '計分方式', value: '五科積分相加再加上作文積分', icon: 'fa-plus' },
          { title: '區域說明', value: '台南市考生', icon: 'fa-info-circle' }
        ]
      },
      'pingtung': {
        description: '屏東區正在籌備中，計分方式尚在設計階段。',
        details: [
          { title: '主要依據', value: '籌備中', icon: 'fa-tools' },
          { title: '預計上線', value: '2025年6月', icon: 'fa-calendar-alt' }
        ]
      },
      'yilan': {
        description: '宜蘭區正在籌備中，計分方式尚在設計階段。',
        details: [
          { title: '主要依據', value: '籌備中', icon: 'fa-tools' },
          { title: '預計上線', value: '2025年6月', icon: 'fa-calendar-alt' }
        ]
      },
      'hualien': {
        description: '花蓮區正在籌備中，計分方式尚在設計階段。',
        details: [
          { title: '主要依據', value: '籌備中', icon: 'fa-tools' },
          { title: '預計上線', value: '2025年6月', icon: 'fa-calendar-alt' }
        ]
      }
    };
    
    return scoringMethods[region] || null;
  }

  // 打開職業群別選擇彈窗
  document.getElementById('vocationalSelectBtn').addEventListener('click', function() {
    document.getElementById('vocationalGroupModal').style.display = 'block';
    document.body.style.overflow = 'hidden'; // 防止背景滾動
  });

  // 關閉職業群別選擇彈窗
  function closeVocationalModal() {
    document.getElementById('vocationalGroupModal').style.display = 'none';
    document.body.style.overflow = 'auto'; // 恢復背景滾動
  }

  // 當用戶點擊彈窗外的區域時關閉彈窗
  window.addEventListener('click', function(event) {
    if (event.target == document.getElementById('vocationalGroupModal')) {
      closeVocationalModal();
    }
  });

  // 切換全選/取消全選
  function toggleAllVocationalGroups() {
    const allCheckbox = document.getElementById('groupAll');
    const checkboxes = document.querySelectorAll('.vocational-group-input:not(#groupAll)');
    
    checkboxes.forEach(checkbox => {
      checkbox.checked = allCheckbox.checked;
    });
    
    updateVocationalGroupsSelection();
  }

  // 更新職業群別選擇狀態
  function updateVocationalGroupsSelection() {
    const checkboxes = document.querySelectorAll('.vocational-group-input:not(#groupAll)');
    const allCheckbox = document.getElementById('groupAll');
    
    // 檢查是否有任何子選項被選中
    let anyChecked = false;
    let allChecked = true;
    
    checkboxes.forEach(checkbox => {
      if (checkbox.checked) {
        anyChecked = true;
      } else {
        allChecked = false;
      }
    });
    
    // 根據子選項狀態更新全選框
    allCheckbox.checked = allChecked;
    
    // 如果沒有任何子選項被選中，自動選中全部
    if (!anyChecked) {
      allCheckbox.checked = true;
    }
  }

  // 確認職業群別選擇
  function confirmVocationalGroups() {
    const selectedGroups = [];
    const checkboxes = document.querySelectorAll('.vocational-group-input:checked');
    const allCheckbox = document.getElementById('groupAll');
    const otherCheckboxes = document.querySelectorAll('.vocational-group-input:not(#groupAll)');
    
    // 檢查是否有任何非全部選項被選中
    let anyOtherChecked = false;
    otherCheckboxes.forEach(checkbox => {
      if (checkbox.checked) {
        anyOtherChecked = true;
        selectedGroups.push(checkbox.value);
      }
    });
    
    // 如果沒有選擇任何群別或只選了「全部」，則設置為全部
    if (!anyOtherChecked || (selectedGroups.length === 0 && allCheckbox.checked)) {
      // 選中全部選項
      allCheckbox.checked = true;
      selectedGroups.length = 0;  // 清空數組
      selectedGroups.push('all');
      
      // 更新隱藏的select元素
      const selectElement = document.getElementById('vocationalGroup');
      selectElement.innerHTML = '';
      const option = document.createElement('option');
      option.value = 'all';
      option.text = '全部';
      option.selected = true;
      selectElement.appendChild(option);
      
      // 更新顯示文字
      document.getElementById('selectedVocationalGroups').textContent = '全部';
      
      closeVocationalModal();
      return;
    }
    
    // 如果有選擇非全部的選項，則判斷是否所有選項都被選中
    if (selectedGroups.length === otherCheckboxes.length) {
      // 如果所有選項都被選中，相當於選擇了全部
      selectedGroups.length = 0;  // 清空數組
      selectedGroups.push('all');
      
      // 更新顯示文字
      document.getElementById('selectedVocationalGroups').textContent = '全部';
    } else {
      // 更新顯示文字
      const selectedText = document.getElementById('selectedVocationalGroups');
      if (selectedGroups.length > 3) {
        selectedText.textContent = `已選擇 ${selectedGroups.length} 個群別`;
      } else {
        selectedText.textContent = selectedGroups.join('、');
      }
    }
    
    // 更新隱藏的select元素，用於表單提交
    const selectElement = document.getElementById('vocationalGroup');
    selectElement.innerHTML = '';
    
    selectedGroups.forEach(group => {
      const option = document.createElement('option');
      option.value = group;
      option.text = group;
      option.selected = true;
      selectElement.appendChild(option);
    });
    
    closeVocationalModal();
  }
</script>

<!-- 更新日誌相關函數 -->
<script>
  // 更新日誌相關函數
  function showChangeLog() {
    document.getElementById('changeLogModal').style.display = 'block';
    document.body.style.overflow = 'hidden'; // 防止背景滾動
  }
  
  function closeChangeLog() {
    document.getElementById('changeLogModal').style.display = 'none';
    document.body.style.overflow = 'auto'; // 恢復背景滾動
  }
  
  // 當用戶點擊彈窗外的區域時關閉彈窗
  window.addEventListener('click', function(event) {
    if (event.target == document.getElementById('changeLogModal')) {
      closeChangeLog();
    }
  });
</script>
  </body>
</html>
